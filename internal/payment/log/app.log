{"message":"waiting for order grpc client, timeout: 10 seconds","severity":"info","time":"2025-04-25T14:06:21+08:00"}
{"message":"Discovered 1 instance of order address from consul, addrs:[127.0.0.1:5002]","severity":"info","time":"2025-04-25T14:06:21+08:00"}
{"message":"Payment recieves a message from order.created, mag: {\"ID\":\"680b2663fdd4ab205e8b9fb3\",\"CustomerID\":\"1234\",\"Status\":\"pending\",\"PaymentLink\":\"\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Name\":\"Fried Chicken Burger\",\"Quantity\":1,\"PriceID\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\"}]}","severity":"info","time":"2025-04-25T14:06:27+08:00","trace":"7a6ac9584f18d22554c2896f078eb02c"}
{"cmd":{"Order":{"ID":"680b2663fdd4ab205e8b9fb3","CustomerID":"1234","Status":"pending","PaymentLink":"","Items":[{"ID":"prod_S8Kcs4H65OdCxg","Name":"Fried Chicken Burger","Quantity":1,"PriceID":"price_1RE3xECQIkU5HEs5mCwUNKQ5"}]}},"message":"CreatePaymentHandler_command_execute_success","severity":"info","time":"2025-04-25T14:06:33+08:00","trace":"7a6ac9584f18d22554c2896f078eb02c"}
{"command":"CreatePayment","command_body":"{\"Order\":{\"ID\":\"680b2663fdd4ab205e8b9fb3\",\"CustomerID\":\"1234\",\"Status\":\"pending\",\"PaymentLink\":\"\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Name\":\"Fried Chicken Burger\",\"Quantity\":1,\"PriceID\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\"}]}}","message":"Query executed successfully","severity":"info","time":"2025-04-25T14:06:33+08:00","trace":"7a6ac9584f18d22554c2896f078eb02c"}
{"message":"consume success","severity":"info","time":"2025-04-25T14:06:33+08:00","trace":"7a6ac9584f18d22554c2896f078eb02c"}
{"args":"{\"id\":\"evt_3RHfPNCQIkU5HEs51Fsjl6OV\",\"object\":\"event\",\"api_version\":\"2025-03-31.basil\",\"created\":1745561205,\"data\":{\"object\":{\"id\":\"pi_3RHfPNCQIkU5HEs51wqDP1Uw\",\"object\":\"payment_intent\",\"amount\":1800,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":1800,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":null,\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"automatic_async\",\"client_secret\":\"pi_3RHfPNCQIkU5HEs51wqDP1Uw_secret_FP4prsVIZHwcZUfLlPL1YMoOJ\",\"confirmation_method\":\"automatic\",\"created\":1745561205,\"currency\":\"cny\",\"customer\":null,\"description\":null,\"last_payment_error\":null,\"latest_charge\":\"ch_3RHfPNCQIkU5HEs51uAXgj8n\",\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":\"pm_1RHfPMCQIkU5HEs5AOcAwZTl\",\"payment_method_configuration_details\":null,\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"}},\"payment_method_types\":[\"card\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":null,\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"succeeded\",\"transfer_data\":null,\"transfer_group\":null}},\"livemode\":false,\"pending_webhooks\":2,\"request\":{\"id\":null,\"idempotency_key\":\"b90e1157-9d0c-47a8-aed4-891277843576\"},\"type\":\"payment_intent.succeeded\"}","from":"127.0.0.1","message":"_request_in","severity":"info","start":1745561206,"time":"2025-04-25T14:06:46+08:00","trace":"00000000000000000000000000000000","uri":"/api/webhook"}
{"args":"{\"id\":\"evt_3RHfPNCQIkU5HEs51Vc9mFCn\",\"object\":\"event\",\"api_version\":\"2025-03-31.basil\",\"created\":1745561205,\"data\":{\"object\":{\"id\":\"ch_3RHfPNCQIkU5HEs51uAXgj8n\",\"object\":\"charge\",\"amount\":1800,\"amount_captured\":1800,\"amount_refunded\":0,\"application\":null,\"application_fee\":null,\"application_fee_amount\":null,\"balance_transaction\":null,\"billing_details\":{\"address\":{\"city\":null,\"country\":\"TW\",\"line1\":null,\"line2\":null,\"postal_code\":null,\"state\":null},\"email\":\"1061603606@qq.com\",\"name\":\"aa\",\"phone\":null,\"tax_id\":null},\"calculated_statement_descriptor\":\"Stripe\",\"captured\":true,\"created\":1745561205,\"currency\":\"cny\",\"customer\":null,\"description\":null,\"destination\":null,\"dispute\":null,\"disputed\":false,\"failure_balance_transaction\":null,\"failure_code\":null,\"failure_message\":null,\"fraud_details\":{},\"livemode\":false,\"metadata\":{},\"on_behalf_of\":null,\"order\":null,\"outcome\":{\"advice_code\":null,\"network_advice_code\":null,\"network_decline_code\":null,\"network_status\":\"approved_by_network\",\"reason\":null,\"risk_level\":\"normal\",\"risk_score\":23,\"seller_message\":\"Payment complete.\",\"type\":\"authorized\"},\"paid\":true,\"payment_intent\":\"pi_3RHfPNCQIkU5HEs51wqDP1Uw\",\"payment_method\":\"pm_1RHfPMCQIkU5HEs5AOcAwZTl\",\"payment_method_details\":{\"card\":{\"amount_authorized\":1800,\"authorization_code\":null,\"brand\":\"visa\",\"checks\":{\"address_line1_check\":null,\"address_postal_code_check\":null,\"cvc_check\":\"pass\"},\"country\":\"US\",\"exp_month\":3,\"exp_year\":2033,\"extended_authorization\":{\"status\":\"disabled\"},\"fingerprint\":\"AYsfIPXHGpG4LNrR\",\"funding\":\"credit\",\"incremental_authorization\":{\"status\":\"unavailable\"},\"installments\":null,\"last4\":\"4242\",\"mandate\":null,\"multicapture\":{\"status\":\"unavailable\"},\"network\":\"visa\",\"network_token\":{\"used\":false},\"network_transaction_id\":\"658911510273808\",\"overcapture\":{\"maximum_amount_capturable\":1800,\"status\":\"unavailable\"},\"regulated_status\":\"unregulated\",\"three_d_secure\":null,\"wallet\":null},\"type\":\"card\"},\"radar_options\":{},\"receipt_email\":null,\"receipt_number\":null,\"receipt_url\":\"https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUkUzcDRDUUlrVTVIRXM1KPbMrMAGMgZx_0PEokY6LBbrRhIC9SUlIfOrdxYDKGLlAFKFe6UOfTNxrthR30frx75U_rD1IngqP5nx\",\"refunded\":false,\"review\":null,\"shipping\":null,\"source\":null,\"source_transfer\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"succeeded\",\"transfer_data\":null,\"transfer_group\":null}},\"livemode\":false,\"pending_webhooks\":2,\"request\":{\"id\":null,\"idempotency_key\":\"b90e1157-9d0c-47a8-aed4-891277843576\"},\"type\":\"charge.succeeded\"}","from":"127.0.0.1","message":"_request_in","severity":"info","start":1745561206,"time":"2025-04-25T14:06:46+08:00","trace":"00000000000000000000000000000000","uri":"/api/webhook"}
{"message":"receive webhook from stripe","severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"4284bfd279db60569a873ffae53d6fd3"}
{"message":"receive webhook from stripe","severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"4d62d9e516b58b404920c3320814da86"}
{"message":"handleWebhook success","severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"4284bfd279db60569a873ffae53d6fd3"}
{"cost_ms":0,"message":"_request_out","response":null,"severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"00000000000000000000000000000000"}
{"message":"handleWebhook success","severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"4d62d9e516b58b404920c3320814da86"}
{"cost_ms":1,"message":"_request_out","response":null,"severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"00000000000000000000000000000000"}
{"args":"{\"id\":\"evt_1RHfPOCQIkU5HEs5jZieERZn\",\"object\":\"event\",\"api_version\":\"2025-03-31.basil\",\"created\":1745561206,\"data\":{\"object\":{\"id\":\"cs_test_a117gcbuVtkdPZ9zT2YTB56WloYX5ice3AYQ5P1yxzvbJFgF0zzMtWogPt\",\"object\":\"checkout.session\",\"adaptive_pricing\":{\"enabled\":true},\"after_expiration\":null,\"allow_promotion_codes\":null,\"amount_subtotal\":1800,\"amount_total\":1800,\"automatic_tax\":{\"enabled\":false,\"liability\":null,\"provider\":null,\"status\":null},\"billing_address_collection\":null,\"cancel_url\":null,\"client_reference_id\":null,\"client_secret\":null,\"collected_information\":null,\"consent\":null,\"consent_collection\":null,\"created\":1745561193,\"currency\":\"cny\",\"currency_conversion\":null,\"custom_fields\":[],\"custom_text\":{\"after_submit\":null,\"shipping_address\":null,\"submit\":null,\"terms_of_service_acceptance\":null},\"customer\":null,\"customer_creation\":\"if_required\",\"customer_details\":{\"address\":{\"city\":null,\"country\":\"TW\",\"line1\":null,\"line2\":null,\"postal_code\":null,\"state\":null},\"email\":\"1061603606@qq.com\",\"name\":\"aa\",\"phone\":null,\"tax_exempt\":\"none\",\"tax_ids\":[]},\"customer_email\":null,\"discounts\":[],\"expires_at\":1745647593,\"invoice\":null,\"invoice_creation\":{\"enabled\":false,\"invoice_data\":{\"account_tax_ids\":null,\"custom_fields\":null,\"description\":null,\"footer\":null,\"issuer\":null,\"metadata\":{},\"rendering_options\":null}},\"livemode\":false,\"locale\":null,\"metadata\":{\"customerID\":\"1234\",\"status\":\"pending\",\"orderID\":\"680b2663fdd4ab205e8b9fb3\",\"paymentLink\":\"\",\"items\":\"[{\\\"ID\\\":\\\"prod_S8Kcs4H65OdCxg\\\",\\\"Name\\\":\\\"Fried Chicken Burger\\\",\\\"Quantity\\\":1,\\\"PriceID\\\":\\\"price_1RE3xECQIkU5HEs5mCwUNKQ5\\\"}]\"},\"mode\":\"payment\",\"payment_intent\":\"pi_3RHfPNCQIkU5HEs51wqDP1Uw\",\"payment_link\":null,\"payment_method_collection\":\"if_required\",\"payment_method_configuration_details\":{\"id\":\"pmc_1RE3pbCQIkU5HEs5cLvtlWh0\",\"parent\":null},\"payment_method_options\":{\"card\":{\"request_three_d_secure\":\"automatic\"}},\"payment_method_types\":[\"card\",\"link\"],\"payment_status\":\"paid\",\"permissions\":null,\"phone_number_collection\":{\"enabled\":false},\"recovered_from\":null,\"saved_payment_method_options\":null,\"setup_intent\":null,\"shipping_address_collection\":null,\"shipping_cost\":null,\"shipping_options\":[],\"status\":\"complete\",\"submit_type\":null,\"subscription\":null,\"success_url\":\"http://localhost:8282/success?customerID=1234\\u0026orderID=680b2663fdd4ab205e8b9fb3\",\"total_details\":{\"amount_discount\":0,\"amount_shipping\":0,\"amount_tax\":0},\"ui_mode\":\"hosted\",\"url\":null,\"wallet_options\":null}},\"livemode\":false,\"pending_webhooks\":2,\"request\":{\"id\":null,\"idempotency_key\":null},\"type\":\"checkout.session.completed\"}","from":"127.0.0.1","message":"_request_in","severity":"info","start":1745561206,"time":"2025-04-25T14:06:46+08:00","trace":"00000000000000000000000000000000","uri":"/api/webhook"}
{"args":"{\"id\":\"evt_3RHfPNCQIkU5HEs51A6zQFN4\",\"object\":\"event\",\"api_version\":\"2025-03-31.basil\",\"created\":1745561205,\"data\":{\"object\":{\"id\":\"pi_3RHfPNCQIkU5HEs51wqDP1Uw\",\"object\":\"payment_intent\",\"amount\":1800,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":0,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":null,\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"automatic_async\",\"client_secret\":\"pi_3RHfPNCQIkU5HEs51wqDP1Uw_secret_FP4prsVIZHwcZUfLlPL1YMoOJ\",\"confirmation_method\":\"automatic\",\"created\":1745561205,\"currency\":\"cny\",\"customer\":null,\"description\":null,\"last_payment_error\":null,\"latest_charge\":null,\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":null,\"payment_method_configuration_details\":null,\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"}},\"payment_method_types\":[\"card\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":null,\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"requires_payment_method\",\"transfer_data\":null,\"transfer_group\":null}},\"livemode\":false,\"pending_webhooks\":2,\"request\":{\"id\":null,\"idempotency_key\":\"b90e1157-9d0c-47a8-aed4-891277843576\"},\"type\":\"payment_intent.created\"}","from":"127.0.0.1","message":"_request_in","severity":"info","start":1745561206,"time":"2025-04-25T14:06:46+08:00","trace":"00000000000000000000000000000000","uri":"/api/webhook"}
{"message":"receive webhook from stripe","severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"36f66dbf585c5d0fc53d0245857df3d6"}
{"message":"receive webhook from stripe","severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"6c9f3e87b224da720a96dbbecfaef6ea"}
{"message":"handleWebhook success","severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"6c9f3e87b224da720a96dbbecfaef6ea"}
{"cost_ms":0,"message":"_request_out","response":null,"severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"00000000000000000000000000000000"}
{"args":"{\"Channel\":{},\"Routing\":\"fan-out\",\"Queue\":\"\",\"Exchange\":\"order.paid\",\"Body\":{\"ID\":\"680b2663fdd4ab205e8b9fb3\",\"CustomerID\":\"1234\",\"Status\":\"paid\",\"PaymentLink\":\"\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Name\":\"Fried Chicken Burger\",\"Quantity\":1,\"PriceID\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\"}]}}","cost_ms":0,"message":"_mq_publish_success","response":null,"severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"36f66dbf585c5d0fc53d0245857df3d6"}
{"message":"handleWebhook success","severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"36f66dbf585c5d0fc53d0245857df3d6"}
{"cost_ms":1,"message":"_request_out","response":null,"severity":"info","time":"2025-04-25T14:06:46+08:00","trace":"00000000000000000000000000000000"}
{"args":"{\"id\":\"evt_3RHfPNCQIkU5HEs51FDJxt8B\",\"object\":\"event\",\"api_version\":\"2025-03-31.basil\",\"created\":1745561208,\"data\":{\"object\":{\"id\":\"ch_3RHfPNCQIkU5HEs51uAXgj8n\",\"object\":\"charge\",\"amount\":1800,\"amount_captured\":1800,\"amount_refunded\":0,\"application\":null,\"application_fee\":null,\"application_fee_amount\":null,\"balance_transaction\":\"txn_3RHfPNCQIkU5HEs511ZDTA0A\",\"billing_details\":{\"address\":{\"city\":null,\"country\":\"TW\",\"line1\":null,\"line2\":null,\"postal_code\":null,\"state\":null},\"email\":\"1061603606@qq.com\",\"name\":\"aa\",\"phone\":null,\"tax_id\":null},\"calculated_statement_descriptor\":\"Stripe\",\"captured\":true,\"created\":1745561205,\"currency\":\"cny\",\"customer\":null,\"description\":null,\"destination\":null,\"dispute\":null,\"disputed\":false,\"failure_balance_transaction\":null,\"failure_code\":null,\"failure_message\":null,\"fraud_details\":{},\"livemode\":false,\"metadata\":{},\"on_behalf_of\":null,\"order\":null,\"outcome\":{\"advice_code\":null,\"network_advice_code\":null,\"network_decline_code\":null,\"network_status\":\"approved_by_network\",\"reason\":null,\"risk_level\":\"normal\",\"risk_score\":23,\"seller_message\":\"Payment complete.\",\"type\":\"authorized\"},\"paid\":true,\"payment_intent\":\"pi_3RHfPNCQIkU5HEs51wqDP1Uw\",\"payment_method\":\"pm_1RHfPMCQIkU5HEs5AOcAwZTl\",\"payment_method_details\":{\"card\":{\"amount_authorized\":1800,\"authorization_code\":null,\"brand\":\"visa\",\"checks\":{\"address_line1_check\":null,\"address_postal_code_check\":null,\"cvc_check\":\"pass\"},\"country\":\"US\",\"exp_month\":3,\"exp_year\":2033,\"extended_authorization\":{\"status\":\"disabled\"},\"fingerprint\":\"AYsfIPXHGpG4LNrR\",\"funding\":\"credit\",\"incremental_authorization\":{\"status\":\"unavailable\"},\"installments\":null,\"last4\":\"4242\",\"mandate\":null,\"multicapture\":{\"status\":\"unavailable\"},\"network\":\"visa\",\"network_token\":{\"used\":false},\"network_transaction_id\":\"658911510273808\",\"overcapture\":{\"maximum_amount_capturable\":1800,\"status\":\"unavailable\"},\"regulated_status\":\"unregulated\",\"three_d_secure\":null,\"wallet\":null},\"type\":\"card\"},\"radar_options\":{},\"receipt_email\":null,\"receipt_number\":null,\"receipt_url\":\"https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUkUzcDRDUUlrVTVIRXM1KPjMrMAGMgaYgVcmdko6LBayjjKHtC8c7lkayL0NUsv1dAGGVwRqeMrIqqmC5tZdYFTS35Fd8UedaG4B\",\"refunded\":false,\"review\":null,\"shipping\":null,\"source\":null,\"source_transfer\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"succeeded\",\"transfer_data\":null,\"transfer_group\":null},\"previous_attributes\":{\"balance_transaction\":null,\"receipt_url\":\"https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUkUzcDRDUUlrVTVIRXM1KPjMrMAGMga-fRhfQ_o6LBZE632pba4SS-XQXN4m2AA1fKDJRT5WQ8HCqEB1dDD2mMVRx8bvVOHMhhxG\"}},\"livemode\":false,\"pending_webhooks\":2,\"request\":{\"id\":null,\"idempotency_key\":null},\"type\":\"charge.updated\"}","from":"127.0.0.1","message":"_request_in","severity":"info","start":1745561208,"time":"2025-04-25T14:06:48+08:00","trace":"00000000000000000000000000000000","uri":"/api/webhook"}
{"message":"receive webhook from stripe","severity":"info","time":"2025-04-25T14:06:48+08:00","trace":"c8505afe55c0250a9ed107beda0bdc66"}
{"message":"handleWebhook success","severity":"info","time":"2025-04-25T14:06:48+08:00","trace":"c8505afe55c0250a9ed107beda0bdc66"}
{"cost_ms":0,"message":"_request_out","response":null,"severity":"info","time":"2025-04-25T14:06:48+08:00","trace":"00000000000000000000000000000000"}
