{"level":"info","msg":"waiting for stock grpc client, timeout: 10 seconds","time":"2025-04-25 14:01:24"}
{"level":"info","msg":"Discovered 1 instance of stock address from consul, addrs:[127.0.0.1:5003]","time":"2025-04-25 14:01:24"}
{"grpcAddr":"127.0.0.1:5002","level":"info","msg":"registered to consul","serviceName":"order","time":"2025-04-25 14:01:24"}
{"level":"info","msg":"staring grpc server, listening on 127.0.0.1:5002","time":"2025-04-25 14:01:24"}
{"level":"info","msg":"waiting for stock grpc client, timeout: 10 seconds","time":"2025-04-25 14:03:08"}
{"level":"info","msg":"Discovered 1 instance of stock address from consul, addrs:[127.0.0.1:5003]","time":"2025-04-25 14:03:08"}
{"grpcAddr":"127.0.0.1:5002","level":"info","msg":"registered to consul","serviceName":"order","time":"2025-04-25 14:03:08"}
{"level":"info","msg":"staring grpc server, listening on 127.0.0.1:5002","time":"2025-04-25 14:03:08"}
{"level":"info","msg":"waiting for stock grpc client, timeout: 10 seconds","time":"2025-04-25 14:06:17"}
{"level":"info","msg":"Discovered 1 instance of stock address from consul, addrs:[127.0.0.1:5003]","time":"2025-04-25 14:06:17"}
{"grpcAddr":"127.0.0.1:5002","level":"info","msg":"registered to consul","serviceName":"order","time":"2025-04-25 14:06:17"}
{"level":"info","msg":"staring grpc server, listening on 127.0.0.1:5002","time":"2025-04-25 14:06:17"}
{"args":"{\"customer_id\":\"1234\",\"items\":[{\"id\":\"prod_S8Kcs4H65OdCxg\",\"quantity\":1}]}","from":"127.0.0.1","level":"info","msg":"_request_in","start":1745561187,"time":"2025-04-25 14:06:27","uri":"/api/customer/%7BCustomerID%7D/order?CustomerID=1234"}
{"args":"[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Quantity\":1}]","cost_ms":651,"level":"info","method":"StockGRPC.CheckIfItemsInStock","msg":"_request_success","response":null,"time":"2025-04-25 14:06:27"}
{"args":"{\"order\":{\"ID\":\"\",\"CustomerID\":\"1234\",\"Status\":\"pending\",\"PaymentLink\":\"\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Name\":\"Fried Chicken Burger\",\"Quantity\":1,\"PriceID\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\"}]}}","cost_ms":2,"level":"info","method":"OrderRepositoryMongo.Create","msg":"_request_success","response":null,"time":"2025-04-25 14:06:27"}
{"args":"{\"Channel\":{},\"Routing\":\"direct\",\"Queue\":\"order.created\",\"Exchange\":\"\",\"Body\":{\"ID\":\"680b2663fdd4ab205e8b9fb3\",\"CustomerID\":\"1234\",\"Status\":\"pending\",\"PaymentLink\":\"\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Name\":\"Fried Chicken Burger\",\"Quantity\":1,\"PriceID\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\"}]}}","cost_ms":0,"level":"info","msg":"_mq_publish_success","response":null,"time":"2025-04-25 14:06:27"}
{"cmd":{"CustomerID":"1234","Items":[{"ID":"prod_S8Kcs4H65OdCxg","Quantity":1}]},"level":"info","msg":"CreateOrderHandler_command_execute_success","time":"2025-04-25 14:06:27"}
{"command":"CreateOrder","command_body":"{\"CustomerID\":\"1234\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Quantity\":1}]}","level":"info","msg":"Query executed successfully","time":"2025-04-25 14:06:27"}
{"cost_ms":655,"level":"info","msg":"_request_out","response":"{\"errno\":0,\"message\":\"success\",\"data\":{\"customer_id\":\"1234\",\"order_id\":\"680b2663fdd4ab205e8b9fb3\",\"redirect_url\":\"http://localhost:8282/success?customerID=1234\\u0026orderID=680b2663fdd4ab205e8b9fb3\"},\"trace_id\":\"7a6ac9584f18d22554c2896f078eb02c\"}","time":"2025-04-25 14:06:27"}
{"args":"","from":"127.0.0.1","level":"info","msg":"_request_in","start":1745561189,"time":"2025-04-25 14:06:29","uri":"/success?customerID=1234\u0026orderID=680b2663fdd4ab205e8b9fb3"}
{"cost_ms":4,"level":"info","msg":"_request_out","response":null,"time":"2025-04-25 14:06:29"}
{"args":"","from":"127.0.0.1","level":"info","msg":"_request_in","start":1745561189,"time":"2025-04-25 14:06:29","uri":"/api/customer/1234/order/680b2663fdd4ab205e8b9fb3"}
{"args":"{\"customerID\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\"}","cost_ms":7,"level":"info","method":"OrderRepositoryMongo.Get","msg":"_request_success","response":null,"time":"2025-04-25 14:06:29"}
{"level":"info","msg":"Query executed successfully","query":"GetCustomerOrder","query_body":"{\"CustomerID\":\"1234\",\"OrderID\":\"680b2663fdd4ab205e8b9fb3\"}","time":"2025-04-25 14:06:29"}
{"cost_ms":8,"level":"info","msg":"_request_out","response":"{\"errno\":0,\"message\":\"success\",\"data\":{\"order\":{\"customer_id\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\",\"items\":[{\"id\":\"prod_S8Kcs4H65OdCxg\",\"name\":\"Fried Chicken Burger\",\"price_id\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\",\"quantity\":1}],\"payment_link\":\"\",\"status\":\"pending\"}},\"trace_id\":\"8d7afb94157b39f9fa4a5a6b6bec440d\"}","time":"2025-04-25 14:06:29"}
{"args":{"ID":"680b2663fdd4ab205e8b9fb3","CustomerID":"1234","Status":"waiting_for_payment","Items":[{"ID":"prod_S8Kcs4H65OdCxg","Name":"Fried Chicken Burger","Quantity":1,"PriceID":"price_1RE3xECQIkU5HEs5mCwUNKQ5"}],"PaymentLink":"https://checkout.stripe.com/c/pay/cs_test_a117gcbuVtkdPZ9zT2YTB56WloYX5ice3AYQ5P1yxzvbJFgF0zzMtWogPt#fidkdWxOYHwnPyd1blpxYHZxWjA0V0A2dTFGVExuUDBNQHYwTW5IMW5dYkxVd0p2REBvPE92RGlUVD1mQz1uUUxzcnNnUFJiY2tdQXxnU213XTJtaGxPTUFMPVRuUkFUczZTPWlncld9bD0yNTVMRmx0YUdrUScpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl"},"grpc_metadata":{":authority":["127.0.0.1:5002"],"content-type":["application/grpc"],"traceparent":["00-7a6ac9584f18d22554c2896f078eb02c-6d41e25dac72bcb4-01"],"user-agent":["grpc-go/1.71.0"],"x-b3-sampled":["1"],"x-b3-spanid":["6d41e25dac72bcb4"],"x-b3-traceid":["7a6ac9584f18d22554c2896f078eb02c"]},"level":"info","msg":"_grpc_request_in","time":"2025-04-25 14:06:33"}
{"args":"{\"customerID\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\"}","cost_ms":2,"level":"info","method":"OrderRepositoryMongo.Get","msg":"_request_success","response":null,"time":"2025-04-25 14:06:33"}
{"args":"{\"order\":{\"ID\":\"680b2663fdd4ab205e8b9fb3\",\"CustomerID\":\"1234\",\"Status\":\"waiting_for_payment\",\"PaymentLink\":\"https://checkout.stripe.com/c/pay/cs_test_a117gcbuVtkdPZ9zT2YTB56WloYX5ice3AYQ5P1yxzvbJFgF0zzMtWogPt#fidkdWxOYHwnPyd1blpxYHZxWjA0V0A2dTFGVExuUDBNQHYwTW5IMW5dYkxVd0p2REBvPE92RGlUVD1mQz1uUUxzcnNnUFJiY2tdQXxnU213XTJtaGxPTUFMPVRuUkFUczZTPWlncld9bD0yNTVMRmx0YUdrUScpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Name\":\"Fried Chicken Burger\",\"Quantity\":1,\"PriceID\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\"}]}}","cost_ms":4,"level":"info","method":"OrderRepositoryMongo.Update ","msg":"_request_success","response":null,"time":"2025-04-25 14:06:33"}
{"command":"UpdateOrder","command_body":"","level":"info","msg":"Query executed successfully","time":"2025-04-25 14:06:33"}
{"grpc.code":"OK","grpc.method":"UpdateOrder","grpc.service":"orderpb.OrderService","grpc.start_time":"2025-04-25T14:06:33+08:00","grpc.time_ms":5.65,"level":"info","msg":"finished unary call with code OK","peer.address":"127.0.0.1:64634","span.kind":"server","system":"grpc","time":"2025-04-25 14:06:33"}
{"args":"","from":"127.0.0.1","level":"info","msg":"_request_in","start":1745561193,"time":"2025-04-25 14:06:33","uri":"/success?customerID=1234\u0026orderID=680b2663fdd4ab205e8b9fb3"}
{"cost_ms":0,"level":"info","msg":"_request_out","response":null,"time":"2025-04-25 14:06:33"}
{"args":"","from":"127.0.0.1","level":"info","msg":"_request_in","start":1745561193,"time":"2025-04-25 14:06:33","uri":"/api/customer/1234/order/680b2663fdd4ab205e8b9fb3"}
{"args":"{\"customerID\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\"}","cost_ms":1,"level":"info","method":"OrderRepositoryMongo.Get","msg":"_request_success","response":null,"time":"2025-04-25 14:06:33"}
{"level":"info","msg":"Query executed successfully","query":"GetCustomerOrder","query_body":"{\"CustomerID\":\"1234\",\"OrderID\":\"680b2663fdd4ab205e8b9fb3\"}","time":"2025-04-25 14:06:33"}
{"cost_ms":1,"level":"info","msg":"_request_out","response":"{\"errno\":0,\"message\":\"success\",\"data\":{\"order\":{\"customer_id\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\",\"items\":[{\"id\":\"prod_S8Kcs4H65OdCxg\",\"name\":\"Fried Chicken Burger\",\"price_id\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\",\"quantity\":1}],\"payment_link\":\"https://checkout.stripe.com/c/pay/cs_test_a117gcbuVtkdPZ9zT2YTB56WloYX5ice3AYQ5P1yxzvbJFgF0zzMtWogPt#fidkdWxOYHwnPyd1blpxYHZxWjA0V0A2dTFGVExuUDBNQHYwTW5IMW5dYkxVd0p2REBvPE92RGlUVD1mQz1uUUxzcnNnUFJiY2tdQXxnU213XTJtaGxPTUFMPVRuUkFUczZTPWlncld9bD0yNTVMRmx0YUdrUScpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl\",\"status\":\"waiting_for_payment\"}},\"trace_id\":\"2ba7fa4db4bf2d707afc803404731d2d\"}","time":"2025-04-25 14:06:33"}
{"args":"{\"customerID\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\"}","cost_ms":1,"level":"info","method":"OrderRepositoryMongo.Get","msg":"_request_success","response":null,"time":"2025-04-25 14:06:46"}
{"args":"{\"order\":{\"ID\":\"680b2663fdd4ab205e8b9fb3\",\"CustomerID\":\"1234\",\"Status\":\"paid\",\"PaymentLink\":\"\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Name\":\"Fried Chicken Burger\",\"Quantity\":1,\"PriceID\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\"}]}}","cost_ms":2,"level":"info","method":"OrderRepositoryMongo.Update ","msg":"_request_success","response":null,"time":"2025-04-25 14:06:46"}
{"command":"UpdateOrder","command_body":"","level":"info","msg":"Query executed successfully","time":"2025-04-25 14:06:46"}
{"level":"info","msg":"consume success","time":"2025-04-25 14:06:46"}
{"args":"","from":"127.0.0.1","level":"info","msg":"_request_in","start":1745561208,"time":"2025-04-25 14:06:48","uri":"/api/customer/1234/order/680b2663fdd4ab205e8b9fb3"}
{"args":"{\"customerID\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\"}","cost_ms":2,"level":"info","method":"OrderRepositoryMongo.Get","msg":"_request_success","response":null,"time":"2025-04-25 14:06:48"}
{"level":"info","msg":"Query executed successfully","query":"GetCustomerOrder","query_body":"{\"CustomerID\":\"1234\",\"OrderID\":\"680b2663fdd4ab205e8b9fb3\"}","time":"2025-04-25 14:06:48"}
{"cost_ms":3,"level":"info","msg":"_request_out","response":"{\"errno\":0,\"message\":\"success\",\"data\":{\"order\":{\"customer_id\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\",\"items\":[{\"id\":\"prod_S8Kcs4H65OdCxg\",\"name\":\"Fried Chicken Burger\",\"price_id\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\",\"quantity\":1}],\"payment_link\":\"https://checkout.stripe.com/c/pay/cs_test_a117gcbuVtkdPZ9zT2YTB56WloYX5ice3AYQ5P1yxzvbJFgF0zzMtWogPt#fidkdWxOYHwnPyd1blpxYHZxWjA0V0A2dTFGVExuUDBNQHYwTW5IMW5dYkxVd0p2REBvPE92RGlUVD1mQz1uUUxzcnNnUFJiY2tdQXxnU213XTJtaGxPTUFMPVRuUkFUczZTPWlncld9bD0yNTVMRmx0YUdrUScpJ2N3amhWYHdzYHcnP3F3cGApJ2lkfGpwcVF8dWAnPyd2bGtiaWBabHFgaCcpJ2BrZGdpYFVpZGZgbWppYWB3dic%2FcXdwYHgl\",\"status\":\"paid\"}},\"trace_id\":\"579838c6f2dfd8270918a15825b6bd2e\"}","time":"2025-04-25 14:06:48"}
{"args":{"ID":"680b2663fdd4ab205e8b9fb3","CustomerID":"1234","Status":"ready","Items":[{"ID":"prod_S8Kcs4H65OdCxg","Name":"Fried Chicken Burger","Quantity":1,"PriceID":"price_1RE3xECQIkU5HEs5mCwUNKQ5"}]},"grpc_metadata":{":authority":["127.0.0.1:5002"],"content-type":["application/grpc"],"traceparent":["00-36f66dbf585c5d0fc53d0245857df3d6-7e1caf6c4bcd56e0-01"],"user-agent":["grpc-go/1.71.0"],"x-b3-sampled":["1"],"x-b3-spanid":["7e1caf6c4bcd56e0"],"x-b3-traceid":["36f66dbf585c5d0fc53d0245857df3d6"]},"level":"info","msg":"_grpc_request_in","time":"2025-04-25 14:06:51"}
{"args":"{\"customerID\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\"}","cost_ms":1,"level":"info","method":"OrderRepositoryMongo.Get","msg":"_request_success","response":null,"time":"2025-04-25 14:06:51"}
{"args":"{\"order\":{\"ID\":\"680b2663fdd4ab205e8b9fb3\",\"CustomerID\":\"1234\",\"Status\":\"ready\",\"PaymentLink\":\"\",\"Items\":[{\"ID\":\"prod_S8Kcs4H65OdCxg\",\"Name\":\"Fried Chicken Burger\",\"Quantity\":1,\"PriceID\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\"}]}}","cost_ms":2,"level":"info","method":"OrderRepositoryMongo.Update ","msg":"_request_success","response":null,"time":"2025-04-25 14:06:51"}
{"command":"UpdateOrder","command_body":"","level":"info","msg":"Query executed successfully","time":"2025-04-25 14:06:51"}
{"grpc.code":"OK","grpc.method":"UpdateOrder","grpc.service":"orderpb.OrderService","grpc.start_time":"2025-04-25T14:06:51+08:00","grpc.time_ms":2.792,"level":"info","msg":"finished unary call with code OK","peer.address":"127.0.0.1:64793","span.kind":"server","system":"grpc","time":"2025-04-25 14:06:51"}
{"args":"","from":"127.0.0.1","level":"info","msg":"_request_in","start":1745561213,"time":"2025-04-25 14:06:53","uri":"/api/customer/1234/order/680b2663fdd4ab205e8b9fb3"}
{"args":"{\"customerID\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\"}","cost_ms":1,"level":"info","method":"OrderRepositoryMongo.Get","msg":"_request_success","response":null,"time":"2025-04-25 14:06:53"}
{"level":"info","msg":"Query executed successfully","query":"GetCustomerOrder","query_body":"{\"CustomerID\":\"1234\",\"OrderID\":\"680b2663fdd4ab205e8b9fb3\"}","time":"2025-04-25 14:06:53"}
{"cost_ms":1,"level":"info","msg":"_request_out","response":"{\"errno\":0,\"message\":\"success\",\"data\":{\"order\":{\"customer_id\":\"1234\",\"id\":\"680b2663fdd4ab205e8b9fb3\",\"items\":[{\"id\":\"prod_S8Kcs4H65OdCxg\",\"name\":\"Fried Chicken Burger\",\"price_id\":\"price_1RE3xECQIkU5HEs5mCwUNKQ5\",\"quantity\":1}],\"payment_link\":\"\",\"status\":\"ready\"}},\"trace_id\":\"842c9232cdb3ee7c431e6e0b650111ca\"}","time":"2025-04-25 14:06:53"}
